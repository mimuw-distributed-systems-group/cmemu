---
name: UDIV timing and results tests
description: "Timing and correctness test of udiv"
dumped_symbols:
  results: 300 words
  times: 300 words
configurations:
- { "desc": "big/small", "registerValues": [[4260791909, 3050], [4043679608, 3832],  [296095032, 3241],  [1774713669, 1329],  [3457859904, 1583],  [1852268565, 1030],  [3484443544, 3227],  [2110028010, 303],  [2510414760, 4003],  [837027715, 3566],  [712027995, 2514],  [1702581403, 2759],  [3115626135, 823],  [1922101983, 2173],  [2072353458, 829],  [1871014231, 12],  [1394665899, 3011],  [494861601, 1983],  [2197968764, 866],  [2189150411, 1141],  [3213882103, 1945],  [3922048286, 2278],  [4272494561, 1814],  [3140881677, 2341],  [4043312877, 1773],  [3795273750, 58],  [2842963970, 3810],  [1680709809, 762],  [2973393744, 1379],  [4191937602, 2419],  [2490051841, 3769],  [1047285117, 3693],  [1320789817, 1525],  [2205632454, 195],  [1389594394, 3557],  [2536745736, 395],  [4118021141, 3000],  [557798930, 2913],  [3850950494, 2103],  [1960980334, 2563],  [4103771101, 3592],  [3556304634, 2530],  [4061612155, 2721],  [1273201677, 611],  [3631514768, 2976],  [3559520414, 2060],  [466692651, 1147],  [1833388351, 3066],  [3550936640, 2329],  [2226696622, 2931],  [2393889866, 2690],
 [758827152, 3124],  [2763526453, 798],  [2722749283, 337],  [803925985, 484],  [3501224585, 4095],  [1628807328, 1224],  [640790153, 2339],  [1097298790, 3990],  [352450696, 3281],  [2130229584, 2298],  [645033802, 150],  [2891166614, 2885],  [3668016499, 3285],  [28033508, 3183],  [3923498092, 3603],  [2448773408, 188],  [3595616638, 343],  [489891754, 3864],  [3934765596, 1053],  [1849684467, 2010],  [2788385752, 3173],  [1437177173, 3007],  [1890942892, 3889],  [426266324, 1432],  [737056266, 3506],  [2290687944, 3939],  [3962545280, 1688],  [2824788566, 2785],  [301863149, 921],  [887028456, 2909],  [1501635820, 2886],  [964231412, 1753],  [1787701376, 929],  [305323402, 282],  [2683169424, 1401],  [3573228146, 1942],  [3150641028, 2891],  [1400713620, 606],  [2306915172, 1362],  [915831098, 3516],  [2437523908, 1746],  [3434641547, 3075],  [968532554, 263],  [750704474, 2976],  [3788011555, 933],  [4079760136, 942],  [2659342427, 727],  [627966740, 119],  [1293820956, 1867]
 ]}
- { "desc": "val/0", "registerValues": [[3770410103, 0],  [2512942866, 0],  [882328249, 0],  [2990432050, 0],  [1036076366, 0],  [2768963908, 0],  [4021939249, 0],  [1558719534, 0],  [3155120295, 0],  [828294674, 0],  [3886802956, 0],  [4264240428, 0],  [1337381306, 0],  [1096776587, 0],  [1851113289, 0],  [3353998514, 0],  [1367590561, 0],  [4102363594, 0],  [1130069508, 0],  [3064683268, 0],  [2421821756, 0],  [3029453312, 0],  [1525625543, 0],  [1580157535, 0],  [2454807180, 0],  [920028217, 0],  [3824840771, 0],  [1864569925, 0],  [1577551552, 0],  [14454333, 0],  [4236318493, 0],  [143689083, 0],  [3129938910, 0],  [2367875613, 0],  [3793527399, 0],  [1477614134, 0],  [2071277054, 0],  [737376600, 0],  [924180038, 0],  [3051853758, 0],  [2679203530, 0],  [3928177157, 0],  [3026757902, 0],  [2291644478, 0],  [28997279, 0],  [2270022928, 0],  [3897618296, 0],  [234835141, 0],  [1901463582, 0],  [510875222, 0], ]}
- { "desc": "0/val", "registerValues": [[0, 1987173515],  [0, 107577358],  [0, 1340936400],  [0, 4040209020],  [0, 3561213670],  [0, 4221065353],  [0, 2033800090],  [0, 142169606],  [0, 3622421570],  [0, 1452231624],  [0, 3592913838],  [0, 159136645],  [0, 776458551],  [0, 790959756],  [0, 2843994250],  [0, 1828130277],  [0, 1071049769],  [0, 2521499159],  [0, 326458065],  [0, 3810776160],  [0, 3011027277],  [0, 1268240274],  [0, 2582053334],  [0, 949267416],  [0, 2828284887],  [0, 109204072],  [0, 2551205413],  [0, 606355971],  [0, 1931189790],  [0, 1059291221],  [0, 1471184640],  [0, 2561170364],  [0, 3704548436],  [0, 3344054711],  [0, 1773703898],  [0, 3736926374],  [0, 3225845837],  [0, 819237012],  [0, 3470955669],  [0, 3291808515],  [0, 2962243235],  [0, 3324252940],  [0, 1889773083],  [0, 1562322452],  [0, 1004086574],  [0, 3743738216],  [0, 3937940839],  [0, 1620600400],  [0, 590513419],  [0, 2037571848], ]}
- { "desc": "small/big", "registerValues": [[2760435676, 3347704590], [2566449437, 4117355438],  [299948620, 468048952],  [2527606097, 3029881627],  [2041119152, 2360618348],  [2764473056, 4082247786],  [3763116241, 3820196066],  [1010967665, 1454917258],  [66438531, 399330193],  [1914108005, 2887156557],  [3369496666, 4197493494],  [2838383399, 2977010126],  [1554836737, 2632883633],  [654754899, 3544710781],  [1608802172, 3410498431],  [2144514007, 3828339523],  [1616005348, 3635221754],  [870526520, 3232154843],  [3251336878, 3271361698],  [2405437401, 3675048388],  [2176581143, 3344763179],  [3030615644, 3356246218],  [2172299163, 2292205029],  [4070388604, 4122119193],  [2430735116, 2608188768],  [24126315, 2302573461],  [3608594418, 3702049751],  [3564701453, 4108094690],  [180598699, 2868332764],  [2702744762, 3913382708],  [1517909019, 3250420342],  [3088199267, 3856958505],  [141437676, 402972761],  [3014718150, 3396398327],  [2967832993, 3367383458],  [4074935778, 4227230093],  [333290664, 2603726404],  [1399074382, 2973348156],  [2188096767, 4008427051],  [3477855562, 3819838116],  [2638969448, 3340499597],  [2472340570, 2714565603],  [736327569, 985084236],  [988418213, 2915794347],  [222062319, 1328221247],  [482655573, 947381245],  [701330028, 1869044476],  [3312182693, 3365660253],  [2323168407, 3115680653],  [2467213188, 3414039355],  [3672604475, 3775462762],
 [4150311441, 4255708872],  [3116538434, 3579287966],  [1745575483, 2115101086],  [2719159166, 3748982287],  [2979216602, 4094567729],  [2124567933, 3235937158],  [746785816, 1881654339],  [2106454204, 2528608546],  [795904399, 1289378190],  [1771715164, 3350408310],  [2229021360, 2331519047],  [3844202376, 3966886318],  [1395166905, 2166633698],  [3494458891, 3930333139],  [2257448042, 3334721651],  [3206742365, 3384377381],  [1136563299, 2093173536],  [2055823859, 2693569329],  [1511399421, 2240600953],  [3416810648, 3419063870],  [827432795, 1510467707],  [2337632212, 3039357736],  [2956002838, 3114402530],  [1715448543, 3711654234],  [16316277, 941748062],  [145691130, 1154770772],  [423165947, 3246736196],  [2581205, 871989210],  [4097758927, 4292749796],  [2537823141, 3786593798],  [3023233417, 4224739342],  [2071724353, 3961754171],  [1717115497, 2886056041],  [1976236190, 2844163312],  [4064603602, 4200930189],  [1620585731, 4040884421],  [3535205915, 3661207985],  [499652120, 3741408821],  [547096149, 1658643963],  [2576243402, 3649810616],  [1955962316, 2375436756],  [1294090258, 3128778771],  [3648666691, 4250824950],  [884758105, 3266231666],  [2131770896, 2570840603],  [3664215115, 3930810301],  [4262188476, 4287689506],  [2769199890, 3491788127],  [1917142306, 4022031141]
 ]}
- { "desc": "Edge cases", "registerValues": [[0x80000000, 0x00000001], [0x80000000, 0x00000002], [0x80000000, 0x00000005], [0x00000002, 0x00000001], [0x00000007, 0x00000003], [0x00000007, 0x00000002], [0x0000000b, 0x00000003], [0x0000000b, 0x00000004], [0x000003e8, 0x00000003], [0x000003e8, 0x00000007], [0xffffffff, 0x00000001], [0xffffffff, 0x00000002], [0xffffffff, 0x00000005], [0x7fffffff, 0x00000001], [0x7fffffff, 0x00000002], [0x7fffffff, 0x00000005]]}
...
{% device:line_buffer_enabled = False %}
{% device:write_buffer_enabled = False %}
{% extends "asm.s.tpl" %}
{% block code %}
    @ Prepare cycle counter timer address
    ldr.w  r0, dwt
    mov.w  r1, {{CYCCNT}}

    b.w    tested_code
.thumb_func
end_label:
{% endblock %}

{% block after %}
{{ section("gpram") }}
.align 4
.thumb_func
.type tested_code, %function
tested_code:
{% for (r7Val, r8Val) in registerValues %}
    @ Prepare input values
    ldr  r7, ={{r7Val}}
    ldr  r8, ={{r8Val}}

.align 4
    isb.w

    @ Get start time
    ldr.w  r2, [r0, r1]

    udiv.w r5, r7, r8

    @ Get finish time
    ldr.w  r3, [r0, r1]

    bl.w save
{% endfor %}
    b.w end_label

save:
    subs.n r2, r3, r2

    {{saveTime(r2, r3, r4)}}
    {{saveResult(r5, r3, r4)}}

    bx.n lr
{% endblock %}
